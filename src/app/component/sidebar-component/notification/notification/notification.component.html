<div class="main-content">
  <!-- Header Section -->
  <div class="d-flex justify-content-between align-items-center mb-4 header-section">
    <div>
      <h4 class="fw-bold text-dark mb-1">
        <i class="fas fa-bell me-2 text-primary"></i>Notifications
      </h4>
      <p class="text-muted small mb-0">Stay updated with the latest activities and alerts.</p>
    </div>
    <div class="d-flex gap-2">
      <button class="btn btn-outline-success btn-sm" (click)="markAllAsRead()" *ngIf="getUnreadCount() > 0">
        <i class="fas fa-check-double me-2"></i>Mark All Read
      </button>
      <button class="btn btn-outline-danger btn-sm" (click)="clearAllNotifications()" *ngIf="notifications.length > 0">
        <i class="fas fa-trash-alt me-2"></i>Clear All
      </button>
    </div>
  </div>

  <!-- Tabs -->
  <ul class="nav nav-pills mb-4">
    <li class="nav-item" *ngFor="let tab of tabs; trackBy: trackByTabId">
      <a class="nav-link d-flex align-items-center gap-2 cursor-pointer" [ngClass]="{ 'active': activeTab === tab.id }"
        (click)="switchTab(tab.id); $event.preventDefault()">
        {{ tab.label }}
        <span class="badge bg-white text-primary rounded-pill" *ngIf="tab.count">{{ tab.count }}</span>
      </a>
    </li>
  </ul>

  <!-- Notifications List -->
  <div *ngIf="filteredNotifications.length > 0; else noNotifications" class="row g-3">
    <div class="col-12" *ngFor="let n of filteredNotifications; trackBy: trackByNotificationId">
      <div class="card border-0 shadow-sm notification-card" [ngClass]="{'unread-card': !n.isRead}"
        (click)="onNotificationClick(n)" (touchstart)="onTouchStart($event, n.id)" (touchend)="onTouchEnd()"
        (touchmove)="onTouchMove()">
        <div class="card-body d-flex align-items-center p-3">
          <!-- Icon based on context (simplified logic visually) -->
          <div class="flex-shrink-0 me-3">
            <div class="icon-circle" [ngClass]="n.isRead ? 'bg-light text-secondary' : 'bg-primary-soft text-primary'">
              <i class="fas fa-info-circle"></i>
            </div>
          </div>

          <!-- Content -->
          <div class="flex-grow-1">
            <div class="d-flex justify-content-between align-items-center mb-1">
              <h6 class="mb-0 text-dark fw-bold" [class.fw-normal]="n.isRead">{{ n.message }}</h6>
              <small class="text-muted whitespace-nowrap ms-2">{{ n.time }}</small>
            </div>
            <div class="d-flex align-items-center gap-2">
              <span *ngIf="!n.isRead" class="badge bg-primary rounded-pill" style="font-size: 0.65rem;">New</span>
              <span *ngIf="savedNotifications.has(n.id)" class="badge bg-warning text-dark rounded-pill"
                style="font-size: 0.65rem;">Saved</span>
            </div>
          </div>

          <!-- Action Indicator -->
          <div class="ms-3 text-muted">
            <i class="fas fa-chevron-right small"></i>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- No Notifications Template -->
  <ng-template #noNotifications>
    <div class="text-center py-5">
      <div class="mb-3">
        <i class="fas fa-bell-slash fa-3x text-muted opacity-50"></i>
      </div>
      <h6 class="text-muted">No notifications found</h6>
      <p class="text-muted small">You're all caught up!</p>
    </div>
  </ng-template>

  <!-- Toast -->
  <div class="toast-container position-fixed bottom-0 end-0 p-3" style="z-index: 1060" *ngIf="showToast">
    <div class="toast show align-items-center text-white bg-dark border-0">
      <div class="d-flex">
        <div class="toast-body">{{ toastMessage }}</div>
        <button type="button" class="btn-close btn-close-white me-2 m-auto" (click)="showToast = false"></button>
      </div>
    </div>
  </div>
</div>